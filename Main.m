clc;
clear all;
close all;
[filename,pathname]=uigetfile('*','Load an Image')

% % Read Image
imagen=imread(fullfile(pathname,filename));

% % Show an Image
figure(1)
imshow(imagen);
title('INPUT IMAGE WITH NOISE')  

% Complement
%Include this line of code when segmenting an Image with White Text on Black Background.
%imagen=imcomplement(imagen);

% Convert to gray scale
if size(imagen,3)==3 % RGB image
    imagen=rgb2gray(imagen);
end

% % Convert to binary image
threshold = graythresh(imagen);
imagen =~im2bw(imagen,threshold);

% Remove all object containing fewer than 30 pixels
imagen = bwareaopen(imagen,30);
pause(1)

% Show image binary image
figure(2)
imshow(~imagen);
title('INPUT IMAGE WITHOUT NOISE')

% Label connected components
[M N]=bwlabel(imagen);

% Measure properties of image regions
propied=regionprops(M,'BoundingBox');
hold on

% Plot Bounding Box
for n=1:size(propied,1)
    rectangle('Position',propied(n).BoundingBox,'EdgeColor','g','LineWidth',2)
end
hold off
pause (1)

% Objects extraction
figure(3)
for n=1:N
    [r,c] = find(M==n);
    n1=imagen(min(r):max(r),min(c):max(c));
    imshow(n1);
    pause(0.8)
% %     Resized image
    img=imresize(n1,[58 30]);
    %     disp('jgjhgjhjh')
end
% % %  Zoning on Image
img(20 :20:end,:,:) = 0;       
img(:,10:10:end,:) = 0;       
% image(img);

% % %  Calculate one's in the each block
block1=img(1:20,1:10); 
block1=sum(block1(:)==1);
block2=img(1:20,11:20);
block2=sum(block2(:)==1);
block3=img(1:20,21:30);
block3=sum(block3(:)==1);
block4=img(21:40,1:10);
block4=sum(block4(:)==1);
block5=img(21:40,11:20);
block5=sum(block5(:)==1);
block6=img(21:40,21:30);
block6=sum(block6(:)==1);
block7=img(41:58,1:10);
block7=sum(block7(:)==1);
block8=img(41:58,11:20);
block8=sum(block8(:)==1);
block9=img(41:58,21:30);
block9=sum(block9(:)==1);
variable1=[block1 block2 block3 block4 block5 block6 block7 block8 block9];
v1=variable1;
disp(v1);

% % %  Dataset of (A-Z,0-9)
% 0
a01=[139    45   127   133     0   114   132    45   121];
a02=[3   110   135    67    38    79   126   105     9];
a03=[92   126   111   167     0   171    85   123   102];
a04=[24   117   154   138    20   145   141   114    29];
a05=[24   117   154   138    20   145   141   114    29];
a06=[54    59   115   109     0    97   100    67    58];
a07=[11    23   102    69     0    70   105    25    12];
a08=[13    53   124    97     0    99   123    54    16];
a09=[94    49   111   164     0   171    86    44   102];
a010=[34    50    76   115     0   113    69    39    43];
a011=[77    24    80   126     0   114    71    25    80];
a012=[94    49   111   164     0   171    86    44   102];
a013=[29    91   110   143    22   154   108    78    34];
a014=[44    60    62   154     0    94    53    91    44];
a015=[25    49    85   146     0    92    94    73    19];
% 1
a11=[64   169   171     0   171   171     0   162   162];
a12=[0    58   126     7   141    13   105    45     0];
a13=[71   146   171    48   121   171     0   108   162];
a14=[31   110   134    48   167    24   110    87     0];
a15=[31   110   134    48   167    24   110    87     0];
a16=[56    74   165     3     0   171     0     0   162];
a17=[55   114   171    37    40   171     0    36   162];
a18=[55    74   165     3     0   171     0     0   162];
a19=[63   109   171    21    38   171     0    36   162];
a110=[40    76   127     7    78    57     1   135     0];
a111=[39    97   149    32   107    80     4   157    10];
a112=[56    74   165     3     0   171     0     0   162];
a113=[68    67   171     0     0   171     0     0   162];
a114=[25    36   138     0     0   171     0     0   148];
a115=[56    74   165     3     0   171     0     0   162];
% 2
a21=[111    45   127     0    55    63    85    81    45];
a22=[0    70    97     0    43    24    72    50     0];
a23=[0   109   132     0    68    33   100    88     0];
a24=[73   134    84     0    80    92    75   160    95];
a25=[73   134    84     0    80    92    75   160    95];
a26=[0    83   152     0    42    98    70   155    41];
a27=[0    83   152     0    42    98    70   155    41];
a28=[54    23   112     0    53    31    73    64    75];
a29=[67    41   126     1    82    35    93    78    93];
a210=[0    50    89     0    36    27    67    65    25];
a211=[45    64    88     0    19    50    60    80    63];
a212=[0    50   110     0    14    49    56    70    29];
a213=[54   114   111     0    59    59    70   116   105];
a214=[0    50   110     0    14    49    56    70    29];
a215=[6    59   138     0    30    66    70   110    45];
% 3
a31=[132    45   127     0    56    90   132    45   121];
a32=[157    72   158     0    74   126   158    72   150];
a33=[0    78    98     0    53    28    93    77     1];
a34=[2   108   134     0    71    51   126   104     9];
a35=[57   122   112     0   102   137    98   113   115];
a36=[57   122   112     0   102   137    98   113   115];
a37=[0    75   155     0    72   117    96   109    44];
a38=[0    75   155     0    72   117    96   109    44];
a39=[67    31    98     8    52    87    87    23    63];
a310=[89    61   106    12    75   111   115    45    82];
a311=[0    49    93     0    38    76    74    23    29];
a312=[31    49   102     0    40   106    52    30    67];
a313=[0    40   139     2    78    82    71    47    49];
a314=[31    90   117     0    67   131    76    37    81];
a315=[0    40   139     2    78    82    71    47    49];
% 4
a41=[0    99    16    89    28    99    27    27   102];
a42=[3   137     7    92    67   102    62    74   129];
a43=[0    21    66    45    62    57    27    95    10];
a44=[0    30    87    36    93    87    55   125    39];
a45=[0   117   114    94    98   117    81    99   129];
a46=[0    38   146    47   112    85    74   139    33];
a47=[0    39    53    39    40    64    18    51    83];
a48=[0     7    87    26    36    73    20   101    20];
a49=[0    14   113    49    86    85    35   128    32];
a410=[0    42    76    54    26    86    27    27    87];
a411=[0    18   102    42    42    69    18    92    13];
a412=[0    14   119    40    94    82    54   124    36];
a413=[0    67    76    84    34    86    36    36    92];
a414=[0    95    76    95    65    86    45    58    97];
a415=[0    67    76    82    34    86    36    36    92];
% 5
a51=[136    45    45    59    45   115   132    45   119];
a52=[160    72    72    72    63   161   158    72   159];
a53=[0    81    45     8    58    45    96    78     0];
a54=[2   112    71    18    86    66   127   107     4];
a55=[88   132    97    60   103   140   113   126    92];
a56=[0   122    87    17   121    50   102   108     6];
a57=[0   122    87    17   121    50   102   108     6];
a58=[67    63    65    39    33   108    88    25    61];
a59=[86    72    95    62    42   133   112    39    82];
a510=[2    65    74    20    28    71    69    31    12];
a511=[41    85    60    15    49   109    62    33    51];
a512=[0    93    66     0    25    84    62    29    26];
a513=[41    85    60    15    49   109    62    33    51];
a514=[0    93    66     0    25    84    62    29    26];
a515=[5   108    88    11    86    86    77    41    31];
% 6;
a61=[167    72   149   171    72   119   158    72   150];
a62=[0    80    92    49    61    35    94    76     2];
a63=[3   113   127    66    97    48   127   105     9];
a64=[16   137    43   149    99   151   104   125   113];
a65=[16   137    43   149    99   151   104   125   113];
a66=[1    86    72   109   114    98   140   116    22];
a67=[49    24    66   126    26    74    87    25    82];
a68=[66    50    94   151    49    93   103    51   106];
a69=[12    37    63   105    25    51    90    37    26];
a610=[14    69    99   131    56    54   117    69    31];
a611=[30    56    23   130    29   100    79    26    74];
a612=[10    69    30   110    27    77    75    44    39];
a613=[10    85    35   135    62    95   107    67    58];
a614=[31    79    27   156    51   129    94    54   117];
a615=[10    85    35   135    62    95   107    67    58];
% 7
a71=[93    45   135     0    68    44     7   107     0];
a72=[144    77   157     0    86    68    10   139     1];
a73=[2    68    96     0    70     2    63     6     0];
a74=[26    98   130     1   103     8    88    19     0];
a75=[2   111   122     3   118     7    95    26     0];
a76=[78    54    77     0    77     3     8    84     0];
a77=[42    55    69     9    55     0    89     0     0];
a78=[59    76    91    15    76     0   107     2     0];
a79=[96    99   135     0    37    46     0    93     0];
a710=[52    65   102     0    63     1    56     2     0];
a711=[64    91   107     0    63     2    54     4     0];
a712=[62    63   112     0    22    43     0    71     0];
a713=[52    65   102     0    63     1    56     2     0];
a714=[64    91   107     0    63     2    54     4     0];
a715=[90   123   130    16   122     2   107    25     0];
% 8
a81=[139    45   127   109    57   109   132    45   121];
a82=[167    72   158   137    84   140   158    72   150];
a83=[0    79    98    32    83    38    95    75     2];
a84=[104   118   124   135   100   154   109   114   122];
a85=[16   114   153    87   112   117   141   111    39];
a86=[65    19    83    46    84    71   101    27    64];
a87=[81    49   108    68   111    91   119    47    89];
a88=[4    52    77    21    83    59    93    24    41];
a89=[6    80   114    35   115    77   118    49    50];
a810=[92    20    91    66    99    73    91    21    82];
a811=[116    45   126    85   126   118   125    31   119];
a812=[21   112   111    51   124    79   105    55    67];
a813=[92    20    91    66    99    73    91    21    82];
a814=[8    73    67    34    80    67    70    23    60];
a815=[21   112   111    51   124    79   105    55    67];
% 9
a91=[136    45   126    95    45   129   119    45   120];
a92=[167    72   158   114    72   160   157    72   150];
a93=[3   110   135    34    98    78   124   105     8];
a94=[107   124   127   135   108   153    32   131    19];
a95=[107   124   127   135   108   153    32   131    19];
a96=[17   117   152    80   125   114    61    85     1];
a97=[17   117   152    80   125   114    61    85     1];
a98=[82    23   100    65    27   116    61    21    47];
a99=[112    48   123    80    49   141    87    44    69];
a910=[22    42    90    36    32   101    60    33    13];
a911=[27    77   118    37    58   136    95    61    18];
a912=[84    24    91    97    34   127    18    50    33];
a913=[84    24    91    97    34   127    18    50    33];
a914=[32    54    71    65    28   110    27    61    12];
a915=[101    61    90    92    61   124    73    63    87];
%A
A1=[3   145    10    59    35    78   108    45   112];
A2=[9   165    24    72    83    92   132    63   140];
A3=[0     4   117     0    70    76    66    55    55];
A4=[0    13   153     2    96   113    90    77    84];
A5=[6   169    20    69   115    90   129    72   139];
A6=[0    35   170     7   138   141   103    75   142];
A7=[0    94     0    16    62    44    74     2    99];
A8=[0   111     0    21   103    49    96     7   117];
A9=[0     1    84     0    51    84    63     4    89];
A10=[0    85     0    17    74    30    58     0    93];
A11=[0    86     0    15   101    36    55    27   115];
A12=[0     0    80     0    51    91    50     9    95];
A13=[0     0    92     0    59   135    56     7   122];
A14=[0    86     0    15   101    36    55    27   115];
A15=[0     0    92     0    59   135    56     7   122];
% B
B1=[8   148   157    70   129   130   131   112    77];
B2=[0   100    88    14    65    81    84    22    36];
B3=[0   119   111    18    88    95    92    50    43];
B4=[90    29    90    76    31   105    86    30    91];
B5=[2    93    84    14    70    86    78    33    72];
B6=[2   131   122    19   100    95    80    64    94];
B7=[92    66   126    76    72   116    88    62   123];
B8=[2    93    84    14    70    86    78    33    72];
B9=[2   131   122    19   100    95    80    64    94];
B10=[81    29    93    76    33    93    77    29    82];
B11=[91    63   119    76    63   125    87    62   106];
B12=[55    69    96    92    54   103   117    63    86];
B13=[ 0    66    58     3    62    62    60    27    39];
B14=[0    69    64    14    46    62    68    35    39];
B15=[102    19    81    94    20    72    97    18    75];
% C
C1=[139    45   121   133     0     0   132    45   121];
C2=[166    72   158   171     0     0   157    72   150];
C3=[0    78    93    52    12     0    95    75     1];
C4=[3   112   135    67    24     0   126   105     9];
C5=[66   137   126   168    25     0    58   134   126];
C6=[66   137   126   168    25     0    58   134   126];
C7=[28   119   127   151     7     0   117   125    20];
C8=[28   119   127   151     7     0   117   125    20];
C9=[40    24    69    89     0     0    79    61    32];
C10=[59    46    99   116     0     0    89    82    56];
C11=[20    25    66    74     0     0   105    38     8];
C12=[28    39    84    95     0     0   117    50    16];
C13=[44    31    54    95     0     0    79    33    17];
C14=[46    58    66   141     0     0    99    43    14];
C15=[70    63    80    91     0     3    68    63    82];
% D
D1=[143    45   111   133     0   114   136    45   105];
D2=[171    72   147   171     0   152   162    72   139];
D3=[0    80    92    37    21    68    92    60    10];
D4=[0   113   129    52    44    98   120    91    19];
D5=[171   122    93   171     0   163   162   122    84];
D6=[18   140   141    81    40   140   135   114    43];
D7=[18   140   141    81    40   140   135   114    43];
D8=[109    25    91    95     0    65   105    22    34];
D9=[127    40   108   114     0    80   121    38    54];
D10=[4    73    76    44     7    61    87    15    20];
D11=[8    95    99    46    19    82   103    38    33];
D12=[104    31    81    95     0    82    99    30    71];
D13=[2    79    65    36    15    66    79    29    48];
D14=[104    31    81    95     0    82    99    30    71];
D15=[2    79    65    36    15    66    79    29    48];
% E
E1=[157    45    45   157    45    40   149    45    45];
E2=[171    72    72   171    73    56   162    72    72];
E3=[0    79    45    31    67     7    96    28     0];
E4=[0   117    71    46    98    16   124    60     0];
E5=[171   136   108   171   141   117   162   132   108];
E6=[7   153   103    69   138    50   134   116     3];
E7=[7   153   103    69   138    50   134   116     3];
E8=[85    42    78    76    71    11    78    47    71];
E9=[91    63    99    76    87    16    84    56    98];
E10=[0    89    61    13    87     5    74    38    17];
E11=[0   107    83    19   101     8    84    56    26];
E12=[89    27    40    76    27    39    85    28    46];
E13=[2    92    51    20    57    17    83    29    44];
E14=[89    27    40    76    27    39    85    28    46];
E15=[2    92    51    20    57    17    83    29    44];
% F
F1=[171    83    72   171    83    56   162    18     0];
F2=[0    78    45    31    67     8    74     0     0];
F3=[0   117    70    47    99    13   106     0     0];
F4=[171   136   108   171   141   104   162    72     0];
F5=[5   152   104    65   140    46   129    12     0];
F6=[5   152   104    65   140    46   129    12     0];
F7=[82    48    66    76    80    17    87    56     0];
F8=[0    87    56    11    90     6    80     9     0];
F9=[0   105    81    15   107     8    91    22     0];
F10=[89    96    64    76    99    49    84    82     4];
F11=[2   122    63    31    88    34    85    24     0];
F12=[89    96    64    76    99    49    84    82     4];
F13=[2    87    51    28    51    18    84     2     0];
F14=[2   122    63    31    88    34    85    24     0];
F15=[72    44    57    57    50    32    70    37     0];
% G
G1=[139    45   121   133    15    75   132    45   121];
G2=[167    72   149   171    35   103   158    72   150];
G3=[0    78    95    52    38    22    93    74     2];
G4=[3   112   126    67    69    42   127   106     7];
G5=[87   121    98   152    43   115    84   115   101];
G6=[40   118   137   143    46   116   127   111    45];
G7=[40   118   137   143    46   116   127   111    45];
G8=[52    39    80    99     7    56    87    66   101];
G9=[18    18    61    74     4    43   101    31    50];
G10=[24    37    83    96    11    52   115    50    49];
G11=[80    30    57   132     2    40    76    31   111];
G12=[55    58    64   138     8    55    91    62    53];
G13=[61    30    47    92     0    70    65    32    81];
G14=[46    31    52    93     4    58    69    24    52];
G15=[55    58    64   138     8    55    91    62    53];
% H
H1=[114     0    95   130    45   116   108     0    90];
H2=[0    66    67    43    57    57    62    58     2];
H3=[2    94   102    59    92    73    98    81     5];
H4=[171     0   152   171   108   164   162     0   144];
H5=[38    63   117    95   107   110   114    41    55];
H6=[108     4    98    98    27    83   104     4    94];
H7=[129    13   131   114    45   119   123    13   124];
H8=[10    53    78    48    30    65    78    31    29];
H9=[15    73   104    55    53    70   103    52    33];
H10=[93     8    92    80    27    82    87     8    88];
H11=[17    42    74    50    27    57    73    26    29];
H12=[29    65   113    63    53    76   102    49    40];
H13=[103    12   121    95    37   114   100    12   115];
H14=[17    42    74    50    27    57    73    26    29];
H15=[29    65   113    63    53    76   102    49    40];
% I
I1=[27   171    44     0   171    19    27   162    46];
I2=[58   171    73    19   171    38    57   162    72];
I3=[20   171    25     0   171     0    20   162    24];
I4=[20   171    25     0   171     0    20   162    24];
I5=[0    62    64     0   111     0    40    85     0];
I6=[44   171    52     0   171     0    46   162    45];
I7=[36   171    52     0   171    19    36   162    51];
I8=[31   159    33     0   152     0    31   150    33];
I9=[26   162    27     0   171     0    20   153    27];
I10=[45   162    48     3   171    19    43   153    50];
I11=[0    90    66     0   140     0    54    99     0];
I12=[63   159    63     0   152     0    63   151    63];
I13=[24   144    97     0   143     0    85   146    34];
I14=[16   130    76     0   125     0    71   134    25];
I15=[16   130    76     0   125     0    71   134    25];
% J
J1=[0     0   114     0     0   114   132    45   121];
J2=[0     0   171     9     0   171   157    72   159];
J3=[0     0    70     0    12    47    96    78     0];
J4=[0     0   109     5    26    64   127   110     3];
J5=[0    38   171     0    38   171    90   128   119];
J6=[0     7   148     0    74    76   103   117     7];
J7=[0    73    75     0    57    57    68    52    15];
J8=[0     4    86     0    67     8    46    33     0];
J9=[0    14   101     0    85    11    66    50     0];
J10=[2   106    90     0    95    76   115   100    46];
J11=[0     7    93     0    51    16    73    68     0];
J12=[0    52    92     0   103    19    90   100     0];
J13=[4   106    60     0    95    38    74    86    14];
J14=[0     7    93     0    51    16    73    68     0];
J15=[0    52    92     0   103    19    90   100     0];
% K
K1=[133    59    65   153    93     0   126    36    78];
K2=[171    77    87   171   153     2   162    52   105];
K3=[0    81    55    40    91     0    67    72     0];
K4=[152    84    85   164   153     2   144    64   106];
K5=[40    93    94    95   146     0   114   111    17];
K6=[108    28    51    95    90     0   103    38    77];
K7=[115    67    71    95   118     0   110    62   100];
K8=[2    85    53    36    84     0    83    72    10];
K9=[4   111    79    38   120     0   102    88    16];
K10=[88    38    25    79    75     0    83    41    64];
K11=[6    73    47    40    72     0    74    52    27];
K12=[6   111    54    41   137     0    94    73    38];
K13=[118    18    52   114   111     3   112    46    95];
K14=[6    73    47    40    72     0    74    52    27];
K15=[6   111    54    41   137     0    94    73    38];
% L
L1=[152     0     0   152     0     0   149    45    45];
L2=[171    19     0   171    19     0   162    82    72];
L3=[0    11   100     2   105     5    95    62    18];
L4=[0    37   122     8   142     9   107   108    43];
L5=[171    76     0   171    76     0   162   132   108];
L6=[0   115    99    30   165    10   123   145    97];
L7=[0   115    99    30   165    10   123   145    97];
L8=[101    80     0    76    57     0    87    72   102];
L9=[0    92    29     2    98     0    60    46    56];
L10=[0   101    59     2   130     0    69    83    90];
L11=[89    16     0    76     0     0    85    30    46];
L12=[0   101     9     3    78     0    63    46    54];
L13=[89    16     0    76     0     0    85    30    46];
L14=[0   101     9     3    78     0    63    46    54];
L15=[0   141    14    10   115     0    74    83    70];
% M
M1=[142     0   125   118    88   115    90    57    72];
M2=[163     6   152   152   133   151   126    82   108];
M3=[2    79    82    50    93    66    56    74     7];
M4=[10    95   109    68   136    85    83    99    20];
M5=[104    45   134   119   149   136   110   101   101];
M6=[10   114   134    71   142   127    96    81    96];
M7=[10   114   134    71   142   127    96    81    96];
M8=[79     3    95    32    67    66    64    60    65];
M9=[90    10   114    50    96    81    86    81    88];
M10=[9    57    80    23    72    56    49    57    55];
M11=[10    60    97    35    90    69    64    61    60];
M12=[105    14   116    35    97    95    37    59   105];
M13=[37    47   107    24    84    81    38    76    53];
M14=[99     0   105    51    59    81    50    64    84];
M15=[27    27    80    25    62    57    41    68    48];
% N
N1=[147    13    95   115    93   103   108     4   127];
N2=[169    36   152   171   128   158   162    17   155];
N3=[0    85    62    42    72    52    61    78     2];
N4=[169    38   133   156   136   146   144    21   156];
N5=[54    94   110   102   128   109   106    74    63];
N6=[54    94   110   102   128   109   106    74    63];
N7=[81    37    85    38    77    49    83     1    74];
N8=[8    76    66    25    76    24    62    33    13];
N9=[9    98    86    45    88    45    86    48    13];
N10=[78    34    51    38    77    48    50     2    70];
N11=[97    78    50    38   103    65    55     1    74];
N12=[16    99    42    27    90    34    40    23    24];
N13=[97    78    50    38   103    65    55     1    74];
N14=[16    57    47    28    66    28    41    34    11];
N15=[16    99    42    27    90    34    40    23    24];
% O
O1=[70    62    77    83     0    66    65    62    73];
O2=[91    87   100   133     0   114    86    89    95];
O3=[91   141   105   159     0   143    83   140    99];
O4=[91    87   100   133     0   114    86    89    95];
O5=[63    39    68    89     0    76    62    41    70];
O6=[70    62    77    83     0    66    65    62    73];
O7=[59    59    82    79     0    67    73    55    62];
O8=[48    46    61    56     0    42    58    46    53];
O9=[61    52    66    57     0    41    57    52    63];
O10=[16    29    74    46     0    24    64    32    19];
O11=[70    62    77    83     0    66    65    62    73];
O12=[70    62    77    83     0    66    65    62    73];
O13=[64    48    71    73     0    57    62    48    65];
O14=[70    59    77    86     0    68    66    60    72];
O15=[55    30    70    77     0    61    62    30    53];
% P
P1=[143    45   127   143    45   102   126     0     0];
P2=[0    79    97    39    64    50    69     0     0];
P3=[0   115   134    53    97    73    99     0     0];
P4=[171   113   137   171   108   134   162     0     0];
P5=[15   144   154    79   133   107   131     3     0];
P6=[94    29   115    76    36    29    89    21     0];
P7=[0    99    93    15    73    17    85     4     0];
P8=[73    46   103    57    42    69    70    35     0];
P9=[0    79   134    76    77    72    86    67     0];
P10=[2    98    79    17    61    46    77     5     0];
P11=[2   129   113    24    97    66    85    36     0];
P12=[73    46   103    57    42    69    70    35     0];
P13=[90    79   134    76    77    72    86    67     0];
P14=[2    98    79    17    61    46    77     5     0];
P15=[2   129   113    24    97    66    85    36     0];
% Q
Q1=[126    45   111   114     0   114   120    75   119];
Q2=[157    72   111   152     3   114   149   107   131];
Q3=[0    80    97    52    11    59    93   108     4];
Q4=[4   114   135    69    37    81   127   129    24];
Q5=[95   128    95   143    34   144    71   129   119];
Q6=[95   128    95   143    34   144    71   129   119];
Q7=[42   118   141   137    37   128   106   123    77];
Q8=[42   118   141   137    37   128   106   123    77];
Q9=[58    47    98   112     3    78    25    82    66];
Q10=[25    18    94    86     0    47    34    86    10];
Q11=[42    35   112   107     3    72    44   109    18];
Q12=[45    26    76    84     1    81    62    58    15];
Q13=[67    21    75    94     0    83    15    61    42];
Q14=[96    26   101   138     0   121    15    83    53];
Q15=[61    39   110   135    10   108    70    87    29];
% R
R1=[129    45   137   114    89    75   108    13    98];
R2=[171    72   149   171    91    99   162    30   117];
R3=[0    80    96    40    69    35    68    72     0];
R4=[171   123    86   171   143    64   162    78   102];
R5=[171   123    86   171   143    64   162    78   102];
R6=[12   144   158    76   143    89   130    94    59];
R7=[115    67    84    95   116    16   109    61   100];
R8=[0   100   101    15   114    18    85    45    50];
R9=[0   122   118    19   137    30    94    66    57];
R10=[104    45    45    95    83    15    99    25    66];
R11=[0    97    87    14    82    60    77     8    84];
R12=[2   132   117    20   119    83    83    47   101];
R13=[104    45    45    95    83    15    99    25    66];
R14=[102    51    84    95    93    48    97    46   104];
R15=[0    97    87    14    82    60    77     8    84];
% S
S1=[96   130    78    73   129   112    96   112   121];
S2=[80    24    74    32    87    76    91    26    68];
S3=[105    51    95    44   111    87   120    46    98];
S4=[0    58    62     0    96    35    74    24    21];
S5=[3    88    97     2   118    42   102    62    24];
S6=[110    25    59    62   133   101    86    21    95];
S7=[17    60    63     3    86    32    71    27    55];
S8=[10   104    75     6   121    38    85    58    60];
S9=[83    29    67    33    77    76    72    35    80];
S10=[111    86   106    55   108   104   105    86   117];
S11=[81    60    80    44    69    76    83    63    85];
S12=[81    35    49    68    63    85    57    34    64];
S13=[92    34    70    43    80    80    82    36    87];
S14=[90    53    46    41    79    75    54    54    91];
S15=[84    62    83    43    70    74    85    62    87];
% T
T1=[108   171   109     0   171     0     0   162     0];
T2=[108   171   109     0   171     0     0   162     0];
T3=[69   168   102    56   108     0   129    26     0];
T4=[69   168   102    56   108     0   129    26     0];
T5=[68   108    54     0   114     0     2   119     5];
T6=[99   114    85     0   114     0     8   129    13];
T7=[48   123    39     0   114     0     4   118     6];
T8=[65   156    54     0   152     0     5   148     7];
T9=[39    97    50     3    76     0    60    31     0];
T10=[55   139    63     8   115     0    72    66     0];
T11=[48   123    39     0   114     0     4   118     6];
T12=[55   139    63     8   115     0    72    66     0];
T13=[126   171   126     0   171     0     0   162     0];
T14=[75   158    81    15   111     0    61    57     0];
T15=[63   123    63     0    95     0     0    90     0];
% U
U1=[95     0    76    96     0    76    87    64    94];
U2=[171     0   152   171     0   153   104   128   111];
U3=[74    41   129   127    16   102   138   117    17];
U4=[74    41   129   127    16   102   138   117    17];
U5=[107     2    89    95     0    38    62    31    29];
U6=[72    10    82    70     0    24    78    31     0];
U7=[85    19   101    93     3    39   100    54     0];
U8=[92     4    58    76     0    38    52    39    37];
U9=[106    28    59    95    19    38    59    59    36];
U10=[84     4    48    70     0    30    74    38     2];
U11=[92     4    58    76     0    38    52    39    37];
U12=[84     4    48    70     0    30    74    38     2];
U13=[95     0    76    93     0    76    84    63    88];
U14=[171     0   152   171     0   152   158    72   150];
U15=[114     0    95   114     0    95   102    74   105];
% V
V1=[115     0   110    56    50    78     0   142     8];
V2=[134     9   147    67   107    87     6   160    18];
V3=[131    11   141    55   125    73     1   147     5];
V4=[131    11   141    55   125    73     1   147     5];
V5=[147    22   116   148   124     8   125    33     0];
V6=[147    22   116   148   124     8   125    33     0];
V7=[95     1    78    20    58    22     0    89     0];
V8=[97     1    73    76    34     0    74     3     0];
V9=[91     6    60    11    63    27     0    79     0];
V10=[103    29    57    20   104    22     0    87     0];
V11=[123     7    60   124    40     0    80     1     0];
V12=[91     6    60    11    63    27     0    79     0];
V13=[96    11    56    85    37     0    75     0     0];
V14=[102     1   101    97    73    17    94    65     0];
V15=[120     5   119   112    90    24   104    79     0];
% W
W1=[77   116    73    77   100    84    65    17    83];
W2=[114   126   107   108   148   113    78    68    96];
W3=[52    80    57    72    94    30    77    73     0];
W4=[68   100    86    99   135    43   109   109     0];
W5=[102   116    96    98   146   106    73    66    86];
W6=[95   108    97   134   121    69   129   111     4];
W7=[70    73    52    57    80    26    32    27    26];
W8=[89    91    77    74   112    46    37    46    33];
W9=[67    60    48    60    55    13    44    51     0];
W10=[76    93    78    85   107    27    80    75     0];
W11=[107   100    33    72    84    58    16    28    39];
W12=[70    86    46    76    78     9    47    52     0];
W13=[74    74    37    55    78    30     9    35    33];
W14=[107   100    33    72    84    58    16    28    39];
W15=[104   101    43   107   114    13    58    58     0];
% X
X1=[83    32    93     2   151    10    87    15    99];
X2=[96    75   116    10   171    23   104    52   120];
X3=[75   107   101     7   169    21   104    57   120];
X4=[75   107   101     7   169    21   104    57   120];
X5=[55    54    63     0   108     5    71    13    94];
X6=[0    90    57     0    90     0    57    54    15];
X7=[81    67    55     0   146     9    52    35   106];
X8=[2    75    50     0    81     0    42    63     9];
X9=[51    50    58     0   106     3    55    13    91];
X10=[66    31    79     2   140     8    79    10    87];
X11=[86    70   102     5   168    15   100    42   113];
X12=[82    36    45     1   131     5    58    10    96];
X13=[66    32    75     2   139     6    80    10    88];
X14=[86    70   102     5   168    15   100    42   113];
X15=[46    95    89     2   154    16    88    46    94];
% Y
Y1=[98     7   101     8   127    15     0   108     0];
Y2=[117    37   132    15   161    27     0   144     0];
Y3=[105    84   121     4   161     8     0   144     0];
Y4=[110    28   112     9   132     9     4   126     4];
Y5=[82    29    94    45    81     0    92    16     0];
Y6=[83    17    63     0    98     2     0    87     2];
Y7=[82    60    68    30   108     0    75    59     0];
Y8=[83    17    63     0    98     2     0    87     2];
Y9=[89    45    52     5   133    10     2   132     3];
Y10=[71     4    72     2   103     2     0    61     0];
Y11=[81     9    81     1   108     3     0    72     0];
Y12=[112    49   126     7   168    13     0   162     0];
Y13=[106    32   117     6   147    12     0   108     0];
Y14=[86     3    88     7   116    14     0    90     0];
Y15=[93     8    94     4   117     9     0    72     0];
% Z
Z1=[72   139   126     9   150    15   109   140    96];
Z2=[72   139   126     9   150    15   109   140    96];
Z3=[0   125   120     4   119     7    99   128    18];
Z4=[53    33    82     7    95     1    91    23    65];
Z5=[79    48    98     9   116     4   105    40    89];
Z6=[38    40    98     3    96     2    99    35    48];
Z7=[23    34   101     2    87     3    92    37    40];
Z8=[15    56   125     4   121     8   107    63    37];
Z9=[38    40    98     3    96     2    99    35    48];
Z10=[55    86    95    12   137     3   111    70    76];
Z11=[15    56   125     4   121     8   107    63    37];
Z12=[48    69   127     8    93     5   121    66    63];
Z13=[25    66   125     2    90     6   110    69    43];
Z14=[63   101   146    20   130    12   146    93    81];
Z15=[25    66   125     2    90     6   110    69    43];
% assign letters characters
letter=[A1 A2 A3 A4 A5 A6 A7 A8 A9 A10 A11 A12 A13 A14 A15 B1 B2 B3 B4 B5 B6 B7 B8 B9 B10 B11 B12 B13 B14 B15 C1 C2 C3 C4 C5 C6 C7 C8 C9 C10 C11 C12 C13 C14 C15 D1 D2 D3 D4 D5 D6 D7 D8 D9 D10 D11 D12 D13 D14 D15 E1 E2 E3 E4 E5 E6 E7 E8 E9 E10 E11 E12 E13 E14 E15 F1 F2 F3 F4 F5 F6 F7 F8 F9 F10 F11 F12 F13 F14 F15 G1 G2 G3 G4 G5 G6 G7 G8 G9 G10 G11 G12 G13 G14 G15 H1 H2 H3 H4 H5 H6 H7 H8 H9 H10 H11 H12 H13 H14 H15 I1 I2 I3 I4 I5 I6 I7 I8 I9 I10 I11 I12 I13 I14 I15 J1 J2 J3 J4 J5 J6 J7 J8 J9 J10 J11 J12 J13 J14 J15 K1 K2 K3 K4 K5 K6 K7 K8 K9 K10 K11 K12 K13 K14 K15 L1 L2 L3 L4 L5 L6 L7 L8 L9 L10 L11 L12 L13 L14 L15 M1 M2 M3 M4 M5 M6 M7 M8 M9 M10 M11 M12 M13 M14 M15 N1 N2 N3 N4 N5 N6 N7 N8 N9 N10 N11 N12 N13 N14 N15 O1 O2 O3 O4 O5 O6 O7 O8 O9 O10 O11 O12 O13 O14 O15 P1 P2 P3 P4 P5 P6 P7 P8 P9 P10 P11 P12 P13 P14 P15 Q1 Q2 Q3 Q4 Q5 Q6 Q7 Q8 Q9 Q10 Q11 Q12 Q13 Q14 Q15 R1 R2 R3 R4 R5 R6 R7 R8 R9 R10 R11 R12 R13 R14 R15 S1 S2 S3 S4 S5 S6 S7 S8 S9 S10 S11 S12 S13 S14 S15 T1 T2 T3 T4 T5 T6 T7 T8 T9 T10 T11 T12 T13 T14 T15 U1 U2 U3 U4 U5 U6 U7 U8 U9 U10 U11 U12 U13 U14 U15 V1 V2 V3 V4 V5 V6 V7 V8 V9 V10 V11 V12 V13 V14 V15 W1 W2 W3 W4 W5 W6 W7 W8 W9 W10 W11 W12 W13 W14 W15 X1 X2 X3 X4 X5 X6 X7 X8 X9 X10 X11 X12 X13 X14 X15 Y1 Y2 Y3 Y4 Y5 Y6 Y7 Y8 Y9 Y10 Y11 Y12 Y13 Y14 Y15 Z1 Z2 Z3 Z4 Z5 Z6 Z7 Z8 Z9 Z10 Z11 Z12 Z13 Z14 Z15];
number=[];
character=[];

number=[a11 a12 a13 a14 a15 a16 a17 a18 a19 a110 a111 a112 a113 a114 a115 a21 a22 a23 a24 a25 a26 a27 a28 a29 a210 a211 a212 a213 a214 a215 a31 a32 a33 a34 a35 a36 a37 a38 a39 a310 a311 a312 a313 a314 a315 a41 a42 a43 a44 a45 a46 a47 a48 a49 a410 a411 a412 a413 a414 a415 a51 a52 a53 a54 a55 a56 a57 a58 a59 a510 a511 a512 a513 a514 a515 a61 a62 a63 a64 a65 a66 a67 a68 a69 a610 a611 a612 a613 a614 a615 a71 a72 a73 a74 a75 a76 a77 a78 a79 a710 a711 a712 a713 a714 a715 a81 a82 a83 a84 a85 a86 a87 a88 a89 a810 a811 a812 a813 a814 a815 a91 a92 a93 a94 a95 a96 a97 a98 a99 a910 a911 a912 a913 a914 a915 a01 a02 a03 a04 a05 a06 a07 a08 a09 a010 a011 a012 a013 a014 a015];

character=[letter number];
v2=mat2cell(character,1,[9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9]);
comp=[];
    for n=1:(length(v2))
        %2-D correlation.
        cor=corr2(v2{1,n},v1); 
        comp=[comp cor];
        end
   vd=find(comp==max(comp));
   vd=max(vd);
% % %  Checking the Character
    if vd==1 || vd==2 || vd==3 || vd==4 || vd==5 || vd==6 || vd==7 || vd==8 || vd==9 || vd==10 || vd==11 || vd==12 || vd==13 || vd==14 || vd==15  
        letter='A';
   elseif vd==16 || vd==17 || vd==18 || vd==19 || vd==20 || vd==21 || vd==22 || vd==23 || vd==24 || vd==25 || vd==26 || vd==27 || vd==28 || vd==29 || vd==30  
        letter='B';
   elseif vd==31 || vd==32 || vd==33 || vd==34 || vd==35 || vd==36 || vd==37 || vd==38 || vd==39 || vd==40 || vd==41 || vd==44 || vd==44 || vd==44 || vd==45  
        letter='C';
   elseif vd==46 || vd==47 || vd==48 || vd==49 || vd==50 || vd==51 || vd==52 || vd==53 || vd==54 || vd==55 || vd==56 || vd==57 || vd==58 || vd==59 || vd==60
       letter='D';
   elseif vd==61 || vd==62 || vd==63 || vd==64 || vd==65 || vd==66 || vd==67 || vd==68 || vd==69 || vd==70 || vd==71 || vd==72 || vd==73 || vd==74 || vd==75   
       letter='E';
   elseif vd==76 || vd==77 || vd==78 || vd==79 || vd==80|| vd==81 || vd==82 || vd==83 || vd==84 || vd==85 || vd==86 || vd==87 || vd==88 || vd==89 || vd==90 
       letter='F';
   elseif vd==91 || vd==92 || vd==93 || vd==94 || vd==95 || vd==96 || vd==97 || vd==98 || vd==99 || vd==100 || vd==101 || vd==102 || vd==103 || vd==104 || vd==105
       letter='G';
   elseif vd==106 || vd==107 || vd==108 || vd==109 || vd==110 || vd==111 || vd==112 || vd==113 || vd==114 || vd==115 || vd==116 || vd==117 || vd==118 || vd==119 || vd==120     
       letter='H';
   elseif vd==121 || vd==122 || vd==123 || vd==124 || vd==125 || vd==126 || vd==127 || vd==128 || vd==129 || vd==130 || vd==131 || vd==132 || vd==133 || vd==134 || vd==135   
       letter='I';
   elseif vd==136 || vd==137 || vd==138 || vd==139 || vd==140 || vd==141 || vd==142 || vd==143 || vd==144 || vd==145 || vd==146 || vd==147 || vd==148 || vd==149 || vd==150 
        letter='J';
   elseif vd==151 || vd==152 || vd==153 || vd==154 || vd==155 || vd==156 || vd==157 || vd==158 || vd==159 || vd==160 || vd==161 || vd==162 || vd==163 || vd==164 || vd==165 
       letter='K';
   elseif  vd==166 || vd==167 || vd==168 || vd==169 || vd==170 || vd==171 || vd==172 || vd==173 || vd==174 || vd==175 || vd==176 || vd==177 || vd==178 || vd==179 || vd==180    
       letter='L';
   elseif vd==181 || vd==182 || vd==183 || vd==184 || vd==185 || vd==186 || vd==187 || vd==188 || vd==189 || vd==190 || vd==191 || vd==192 || vd==193 || vd==194 || vd==195 
       letter='M';
   elseif vd==196 || vd==197 || vd==198 || vd==199 || vd==200 || vd==201 || vd==202 || vd==203 || vd==204 || vd==205 || vd==206 || vd==207 || vd==208 || vd==209 || vd==210 
       letter='N';
   elseif  vd==211 || vd==212 || vd==213 || vd==214 || vd==215 || vd==216 || vd==217 || vd==218 || vd==219 || vd==220 ||vd==221 || vd==222 || vd==223 || vd==224 || vd==225 
       letter='O';
   elseif vd==226 || vd==227 || vd==228 || vd==229 || vd==230 ||vd==231 || vd==232 || vd==233 || vd==234 || vd==235 || vd==236 || vd==237 || vd==238 || vd==239 || vd==240 
       letter='P';
   elseif vd==241 || vd==242 || vd==243 || vd==244 || vd==245 || vd==246 || vd==247 || vd==248 || vd==249 || vd==250 ||vd==251 || vd==252 || vd==253 || vd==254 || vd==255 
       letter='Q';
   elseif vd==256 || vd==257 || vd==258 || vd==259 || vd==260 || vd==261 || vd==262 || vd==263 || vd==264 || vd==265 || vd==266 || vd==267 || vd==268 || vd==269 || vd==270 
       letter='R';
   elseif vd==271 || vd==272 || vd==273 || vd==274 || vd==275 ||  vd==276 || vd==277 || vd==278 || vd==279 || vd==280 || vd==281 || vd==282 || vd==283 || vd==284 || vd==285     
       letter='S';
   elseif  vd==286 || vd==287 || vd==288 || vd==289 || vd==290 ||vd==291 || vd==292 || vd==293 || vd==294 || vd==295 || vd==296 || vd==297 || vd==298 || vd==299 || vd==300
       letter='T';
   elseif  vd==301 || vd==302 || vd==303 || vd==304 || vd==305 || vd==306 || vd==307 || vd==308 || vd==309 || vd==310 || vd==311 || vd==312 || vd==313 || vd==314 || vd==315   
       letter='U';
   elseif vd==316 || vd==317 || vd==318 || vd==319 || vd==320 || vd==321 || vd==322 || vd==323 || vd==324 || vd==325 || vd==326 || vd==327 || vd==328 || vd==329 || vd==330
       letter='V';
   elseif vd==331 || vd==332 || vd==333 || vd==334 || vd==335 || vd==336 || vd==337 || vd==338 || vd==339 || vd==340 || vd==341 || vd==342 || vd==343 || vd==344 || vd==345 
       letter='W';
   elseif  vd==346 || vd==347 || vd==348 || vd==349 || vd==350 || vd==351 || vd==352 || vd==353 || vd==354 || vd==355 || vd==356 || vd==357 || vd==358 || vd==359 || vd==360    
       letter='X';
   elseif  vd==361 || vd==362 || vd==363 || vd==364 || vd==365 || vd==366 || vd==367 || vd==368 || vd==369 || vd==370 ||vd==371 || vd==372 || vd==373 || vd==374 || vd==375  
       letter='Y';
   elseif vd==376 || vd==377 || vd==378 || vd==379 || vd==380 || vd==381 || vd==382 || vd==383 || vd==384 || vd==385 || vd==386 || vd==387 || vd==388 || vd==389 || vd==390 
       letter='Z';
   elseif  vd==391 || vd==392 || vd==393 || vd==394 || vd==395 || vd==396 || vd==397 || vd==398 || vd==399 || vd==400 ||  vd==401 || vd==402 || vd==403 || vd==404 || vd==405   
       letter='1';
   elseif vd==406 || vd==407 || vd==408 || vd==409 || vd==410 || vd==411 || vd==412 || vd==413 || vd==414 || vd==415 || vd==416 || vd==417 || vd==418 || vd==419 || vd==420 
       letter='2';
   elseif vd==421 || vd==422 || vd==423 || vd==424 || vd==425 || vd==426 || vd==427 || vd==428 || vd==429 || vd==430 || vd==431 || vd==432 || vd==433 || vd==434 || vd==435 
       letter='3';
   elseif vd==436 || vd==437 || vd==438 || vd==439 || vd==440 || vd==441 || vd==442 || vd==443 || vd==444 || vd==445 || vd==446 || vd==447 || vd==448 || vd==449 || vd==450 
       letter='4';
   elseif vd==451 || vd==452 || vd==453 || vd==454 || vd==455 || vd==456 || vd==457 || vd==458 || vd==459 || vd==460 || vd==461 || vd==462 || vd==463 || vd==464 || vd==465    || vd==456 || vd==457 || vd==458 || vd==459 || vd==460    
       letter='5';
   elseif vd==466 || vd==467 || vd==468 || vd==469 || vd==470 || vd==471  || vd==472 || vd==473 || vd==474 || vd==475 || vd==476 || vd==477 ||    vd==478 || vd==479 || vd==480
       letter='6';
   elseif vd==481 || vd==482 || vd==483 || vd==484 || vd==485 || vd==486 || vd==487 || vd==488 || vd==489 || vd==490 || vd==491 || vd==492 || vd==493 || vd==494 || vd==495
       letter='7';
   elseif vd==496 || vd==497 || vd==498 || vd==499 || vd==500 || vd==501 || vd==502 || vd==503 || vd==504 || vd==505 || vd==506 || vd==507 || vd==508 || vd==509 || vd==510
       letter='8';
   elseif  vd==511 || vd==512 || vd==513 || vd==514 || vd==515 || vd==516 || vd==517 || vd==518 || vd==519 || vd==520 || vd==521 || vd==522 || vd==523 || vd==524 || vd==525
       letter='9';
   elseif vd==526 || vd==527 || vd==528 || vd==529 || vd==530 || vd==531 || vd==532 || vd==533 || vd==534 || vd==535 || vd==536 || vd==537 || vd==538 || vd==539 || vd==540   
       letter='0';
   end
 disp(letter);